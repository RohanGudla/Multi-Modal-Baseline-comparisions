CUDA device found.
ğŸš€ EXPERIMENT 4: COMPLETE DOMAIN MAPPING (EMOTIONSâ†”BEHAVIORS)
======================================================================
ğŸ’» Device: cuda
ğŸ“Š Batch Size: 24 (multi-modal optimized)
âš¡ Automatic Mixed Precision: True
ğŸ¯ FPS: 0.2 (standardized - every 5th frame)
ğŸ“ˆ Epochs: 20
ğŸ§  Model: SmallFastCNN + Multi-Modal Fusion Architecture
ğŸ§  Emotions â†’ Behaviors: 14 â†’ 33
ğŸ­ Behaviors â†’ Emotions: 33 â†’ 14
ğŸ“ Output Directory: /home/tjeei/Multi Modal Collab/experiment_4/
======================================================================
âœ… Domain mapping configuration loaded (14 emotions â†’ 33 behaviors).
ğŸš€ Using optimized preprocessing approach...
âš¡ï¸ Loading pre-processed data from /home/tjeei/Multi Modal Collab/preprocessed_data
ğŸ“Š Found 34 preprocessed participant files
âš¡ Using OptimizedMultiModalDataset
ğŸ“Š Input markers found: 14/14
ğŸ“Š Output markers found: 33/33
ğŸ“Š Dataset created with 7272 samples
ğŸ“Š Dataset: 5817 train, 1455 val samples
ğŸ§  Model parameters: 4,974,057
ğŸ“Š Calculating class weights for positive class optimization...
ğŸ¯ Positive class rate: 0.284
ğŸ¯ Average pos_weight: 4.31 (range: 1.00-10.00)
 ğŸ“‚ Resuming from checkpoint: /home/tjeei/Multi Modal Collab/experiment_4/checkpoints/multi_modal_checkpoint.pth
ğŸ‹ï¸ Training multi-modal model from epoch 20 on cuda...
Traceback (most recent call last):
  File "/home/tjeei/MultiModal Collab/experiment_4_multi_modal.py", line 930, in <module>
    main()
  File "/home/tjeei/MultiModal Collab/experiment_4_multi_modal.py", line 906, in main
    results = train_multi_modal_model(model, train_loader, val_loader, CONFIG, DOMAIN_MAPPING_CONFIG["emotion_to_behavior"])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tjeei/MultiModal Collab/experiment_4_multi_modal.py", line 813, in train_multi_modal_model
    "final_exact_match_accuracy": exact_match_acc,
                                  ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'exact_match_acc' where it is not associated with a value
