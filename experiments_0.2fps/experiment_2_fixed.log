CUDA device found.
ğŸš€ EXPERIMENT 2: MULTI-LABEL CLASSIFICATION
======================================================================
ğŸ’» Device: cuda
ğŸ“Š Batch Size: 32 (multi-label optimized)
âš¡ Automatic Mixed Precision: True
ğŸ¯ FPS: 0.2 (standardized - every 5th frame)
ğŸ“ˆ Epochs: 20
ğŸ§  Model: SmallFastCNN + 47 Multi-label Heads
âš™ï¸ Dataloader Workers: 32
ğŸ“ Output Directory: /home/tjeei/MultiModal Collab/experiment_2/
======================================================================
âœ… 47 markers loaded for multi-label training.
ğŸš€ Using optimized preprocessing approach...
âš¡ï¸ Loading pre-processed data from /home/tjeei/MultiModal Collab/preprocessed_data
ğŸ“Š Found 87 preprocessed participant files
âš¡ Using OptimizedMultiLabelDataset
ğŸ“Š Dataset: 12336 train, 3084 val samples
ğŸ§  Model parameters: 4,836,455
 ğŸ“‚ Resuming from checkpoint: /home/tjeei/MultiModal Collab/experiment_2/checkpoints/multi_label_checkpoint.pth
ğŸ‹ï¸ Training multi-label model from epoch 20 on cuda...

ğŸ’¾ Saving best model outputs...
ğŸ’¾ Saving model outputs for analysis...
Saving outputs:   0%|          | 0/97 [00:00<?, ?it/s]Saving outputs:   1%|          | 1/97 [00:01<02:22,  1.49s/it]Saving outputs:  11%|â–ˆâ–        | 11/97 [00:01<00:11,  7.70it/s]Saving outputs:  27%|â–ˆâ–ˆâ–‹       | 26/97 [00:01<00:03, 20.86it/s]Saving outputs:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 43/97 [00:02<00:01, 38.30it/s]Saving outputs:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 61/97 [00:02<00:00, 58.52it/s]Saving outputs:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 83/97 [00:02<00:00, 85.39it/s]Saving outputs: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 97/97 [00:02<00:00, 41.07it/s]
âœ… Model outputs saved to /home/tjeei/MultiModal Collab/model_outputs/experiment_2_outputs.npz
   Shape: (3084, 47) (samples x markers)
Traceback (most recent call last):
  File "/home/tjeei/MultiModal Collab/experiment_2_multi_label.py", line 913, in <module>
    main()
  File "/home/tjeei/MultiModal Collab/experiment_2_multi_label.py", line 895, in main
    results = train_multi_label_model(model, train_loader, val_loader, CONFIG, all_markers)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tjeei/MultiModal Collab/experiment_2_multi_label.py", line 809, in train_multi_label_model
    final_macro_f1 = macro_f1 
                     ^^^^^^^^
UnboundLocalError: cannot access local variable 'macro_f1' where it is not associated with a value
